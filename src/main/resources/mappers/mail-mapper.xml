<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="mailMapper">

	
	<resultMap type="Mail" id="mailResultSet">
		<id column="mail_no" property="mailNo"/>
		<result column="emp_id" property="empId"/>
		<result column="mail_receiver" property="receiver"/>
		<result column="mail_title" property="title"/>
		<result column="mail_content" property="content"/>
		<result column="mail_date" property="date"/>
		<result column="read_count" property="readCount"/>
		<result column="important_flag" property="importantFlag"/>
		<result column="writer_status" property="writerStatus"/>
		<result column="receiver_status" property="receiverStatus"/>
		<result column="origin_name" property="originName"/>
		<result column="change_name" property="changeName"/>
	</resultMap>
	
	<resultMap type="Mail" id="sendResultSet">
		<id column="mail_no" property="mailNo"/>
		<result column="emp_id" property="empId"/>
		<result column="user_name" property="receiver"/>
		<result column="mail_title" property="title"/>
		<result column="mail_content" property="content"/>
		<result column="mail_date" property="date"/>
		<result column="read_count" property="readCount"/>
		<result column="important_flag" property="importantFlag"/>
		<result column="writer_status" property="writerStatus"/>
		<result column="receiver_status" property="receiverStatus"/>
		<result column="origin_name" property="originName"/>
		<result column="change_name" property="changeName"/>
	</resultMap>
	
	<resultMap id="employeeResultSet" type="Employee">
		<id property="empId" column="EMP_ID"/>
		<result property="jobCode" column="JOB_CODE"/>
		<result property="rightNo" column="RIGHT_NO"/>
		<result property="deptCode" column="DEPT_CODE"/>
		<result property="salLevel" column="SAL_LEVEL"/>
		<result property="hireDate" column="HIRE_DATE"/>
		<result property="modifyDate" column="MODIFIY_DATE"/>
		<result property="endDate" column="END_DATE"/>
		<result property="status" column="STATUS"/>
	</resultMap>
	
	<!-- 메일 작성 -->
	<insert id="insertMail" parameterType="Mail">
		insert into mail
		values(seq_mno.nextval, #{empId}, #{receiver}, #{title}, #{content}, sysdate, default,
				#{importantFlag},  default, default, #{originName}, #{changeName})
	</insert>
	
	<!-- 보낸 메일함 갯수 -->
	<select id="selectSendMailListCount" resultType="_int">
		SELECT COUNT(*)
		FROM MAIL
		WHERE EMP_ID=#{empId}
		AND WRITER_STATUS=1 
	</select>
	
	<!-- 보낸메일함 리스트 받아오기 -->
	<select id="selectSendMailList" resultMap="sendResultSet">
		SELECT
		    *
		FROM MAIL A
		JOIN MEMBER B ON A.MAIL_RECEIVER=B.EMP_ID
		WHERE A.WRITER_STATUS=1
		AND A.EMP_ID=#{empId}
		ORDER BY A.MAIL_NO DESC
	</select>
	
	<select id="selectSendMail" parameterType="_int" resultMap="sendResultSet">
		SELECT
		    *
		FROM MAIL A
		JOIN MEMBER B ON A.MAIL_RECEIVER=B.EMP_ID
		WHERE A.WRITER_STATUS=1
		AND A.MAIL_NO=#{mno}
	</select>
	
	
	<!--
	<select id="selectEmpList" parameterType="Employee">
		select empId
		from employee
	</select>
	  -->
</mapper>
